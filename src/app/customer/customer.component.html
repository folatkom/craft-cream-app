<h1>
  <span id="customer">{{ loggedCustomer }}</span> witaj w świecie craftowych
  lodów!
</h1>
<mat-grid-list cols="2" rowHeight="230px">
  <mat-grid-tile>
    <a>
      <mat-card (click)="showModal('order')">
        <mat-card-title>Twoje dzisiejsze zamówienie</mat-card-title>
        Kliknij aby rozpocząć
      </mat-card>
    </a>
  </mat-grid-tile>
  <mat-grid-tile>
    <a (click)="showModal('offer')">
      <mat-card>
        <mat-card-title>Aktualna oferta</mat-card-title>
      </mat-card>
    </a>
  </mat-grid-tile>
</mat-grid-list>
<div id="modal-container" *ngIf="isModalVisible">
  <mat-card id="modal">
    <mat-icon (click)="toggleModal()">highlight_off</mat-icon>
    <div *ngIf="whichModal === 'offer'; else makeOrder">
      <mat-card-title>Dostępne smaki</mat-card-title>
      <ul>
        <li *ngFor="let flavour of flavours">
          {{ flavour.name }}
          <mat-icon
            *ngIf="isFavourite(flavour.name); else notFavouriteYet"
            (click)="deleteFavourites(flavour.name)"
          >
            favorite</mat-icon
          >
          <ng-template #notFavouriteYet>
            <mat-icon (click)="addToFavourites(flavour)">
              favorite_border
            </mat-icon>
          </ng-template>
        </li>
      </ul>
      <mat-card-title>Dostępne pojemności</mat-card-title>
      <ul>
        <li *ngFor="let container of containers">
          {{ container.name }}
        </li>
      </ul>
    </div>
    <ng-template #makeOrder>
      <mat-card-title>Twoje zamówienie</mat-card-title>
      <ng-container *ngIf="!orderReady">
        <mat-card-subtitle>Ulubione smaki</mat-card-subtitle>
        <app-customer-order-flavour
          *ngFor="let flavour of favourites"
          [flavourName]="flavour.name"
          [containers]="containers"
          (flavour)="updateOrder($event)"
        >
        </app-customer-order-flavour>
        <mat-card-subtitle>Pozostałe smaki</mat-card-subtitle>
        <ng-container *ngFor="let flavour of flavours"
          ><app-customer-order-flavour
            *ngIf="!isFavourite(flavour.name)"
            [flavourName]="flavour.name"
            [containers]="containers"
            (flavour)="updateOrder($event)"
          >
          </app-customer-order-flavour></ng-container
        ><button mat-raised-button color="primary" (click)="createOrder()">
          Zatwierdź
        </button></ng-container
      >

      <ng-container *ngIf="orderReady">
        <mat-card-subtitle>Podsumowanie zamówienia</mat-card-subtitle>
        <ul>
          <li *ngFor="let flavour of order">
            {{ flavour.name }}:
            <ul>
              <li *ngFor="let container of flavour.containers">
                {{ container.name }} - {{ container.quantity }} szt.
              </li>
            </ul>
          </li>
        </ul>
      </ng-container>
    </ng-template>
  </mat-card>
</div>
